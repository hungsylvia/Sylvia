<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»Šå¤©æˆ‘è¦åƒä»€éº¼ (æ–°ç«¹å¸‚) - é¤æœŸç¯©é¸ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        /* è‡ªå®šç¾©æŒ‰éˆ•å‹•ç•« */
        @keyframes bounce-spin {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.03); }
        }
        .spin-active {
            animation: bounce-spin 0.3s infinite alternate;
        }
        /* è¦–è¦ºæ•ˆæœï¼šè®“é¸ä¸­çš„çµæœæ›´çªå‡º */
        .result-highlight {
            transition: all 0.5s ease-in-out;
            text-shadow: 0 0 10px rgba(254, 215, 170, 0.8);
        }
        /* Radio button æ¨£å¼ */
        .meal-radio {
            appearance: none;
            width: 0;
            height: 0;
        }
        .meal-label {
            cursor: pointer;
            padding: 8px 16px;
            border-radius: 9999px;
            font-weight: 600;
            color: #4B5563; /* Gray-600 */
            background-color: #E5E7EB; /* Gray-200 */
            transition: all 0.2s;
        }
        .meal-radio:checked + .meal-label {
            color: white;
            background-color: #0D9488; /* Teal-600 */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex items-center justify-center p-4">

    <div class="w-full max-w-lg p-8 bg-white rounded-xl shadow-2xl transition duration-500 hover:shadow-3xl">
        
        <header class="text-center mb-8">
            <h1 class="text-4xl font-extrabold text-teal-600 mb-2">ä»Šå¤©æˆ‘è¦åƒä»€éº¼ï¼Ÿ</h1>
            <p class="text-lg text-gray-600">æ–°ç«¹å¸‚ç¾é£Ÿå‘½é‹æ±ºå®šæ©Ÿ (é¤æœŸç¯©é¸)</p>
        </header>

        <div class="text-center mb-6">
            <label class="block text-gray-700 font-bold mb-3">è«‹é¸æ“‡æƒ³ç”¨é¤çš„æ™‚æ®µï¼š</label>
            <div id="meal-time-selector" class="flex justify-center flex-wrap gap-4">
                <input type="radio" id="time-morning" name="meal-time" value="morning" class="meal-radio">
                <label for="time-morning" class="meal-label">ğŸŒ æ—©é¤ / æ—©åˆé¤</label>
                
                <input type="radio" id="time-noon" name="meal-time" value="noon" class="meal-radio">
                <label for="time-noon" class="meal-label">ğŸ” åˆé¤</label>
                
                <input type="radio" id="time-evening" name="meal-time" value="evening" class="meal-radio" checked>
                <label for="time-evening" class="meal-label">ğŸ½ï¸ æ™šé¤</label>
                
                <input type="radio" id="time-late" name="meal-time" value="late_night" class="meal-radio">
                <label for="time-late" class="meal-label">ğŸŒœ å®µå¤œ</label>
            </div>
        </div>
        <div class="text-center mb-6 h-20 flex items-center justify-center">
            <p id="result-display" class="text-3xl font-bold text-gray-800 transition duration-500">
                é»æ“Šä¸‹æ–¹æŒ‰éˆ•é–‹å§‹ï¼
            </p>
        </div>

        <div id="final-restaurant-display" class="hidden text-center mb-6 p-4 border border-teal-200 bg-teal-50 rounded-lg">
            <h4 class="text-xl font-bold text-teal-700 mb-2">å¹¸é‹æ˜Ÿæ¨è–¦ï¼š<span id="chosen-restaurant" class="text-orange-600"></span></h4>
            <p class="text-sm text-gray-600" id="chosen-category-text"></p>
        </div>

        <div class="text-center">
            <button id="spin-button" class="bg-orange-500 hover:bg-orange-600 text-white font-bold py-4 px-10 rounded-full transition duration-300 transform hover:scale-105 shadow-lg flex items-center justify-center mx-auto space-x-2">
                <i class="fas fa-utensils text-xl"></i>
                <span id="button-text" class="text-xl">è½‰ï¼</span>
            </button>
        </div>

        <div id="info-links-container" class="mt-6 flex flex-wrap justify-center gap-3 hidden">
             <a id="link-map" href="#" target="_blank" class="info-link bg-teal-500 hover:bg-teal-600 text-white font-semibold py-2 px-4 rounded-lg transition duration-200 text-sm"><i class="fas fa-map-marker-alt mr-1"></i> (è‹¥åµŒå…¥å¤±æ•—) å¦é–‹åœ°åœ–</a>
        </div>

        <section id="map-container" class="mt-8 pt-4 border-t border-gray-100 hidden">
            <h3 class="text-xl font-semibold text-gray-700 mb-3 text-center">åœ°åœ–ä½ç½® (åµŒå…¥)ï¼š</h3>
            <iframe id="map-iframe" width="100%" height="400" frameborder="0" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade" class="rounded-lg shadow-inner"></iframe>
            <p class="text-xs text-gray-400 mt-2 text-center">å‚™è¨»ï¼šåœ°åœ–å¯èƒ½æœƒå›  Google å®‰å…¨æ”¿ç­–è€Œç„¡æ³•é¡¯ç¤ºï¼Œè«‹é»æ“Šä¸Šæ–¹çš„ã€Œå¦é–‹åœ°åœ–ã€ã€‚</p>
        </section>
        <div class="mt-8 pt-6 border-t border-gray-100 text-center">
            <p class="text-sm text-gray-500">
                ç›®å‰åƒèˆ‡è½‰ç›¤çš„é¡åˆ¥ï¼š
                <span id="category-list" class="text-xs italic text-gray-400"></span>
            </p>
        </div>

    </div>

    <script>
        // 1. **æ•¸æ“šçµæ§‹èˆ‡é¤æœŸå®šç¾©**ï¼š
        const foodData = [
            {
                category: "æ—¥å¼æ‹‰éºµ",
                meal_times: ["noon", "evening"],
                restaurants: ["å¤§æµ·æ‹‰éºµ", "éºµå ‚", "å¤ªæ²³æ‹‰éºµ", "å¯«æ¨‚æ‹‰éºµ", "ç·£è€…æ‹‰éºµ", "ä¸€æ¨‚æ‹‰éºµ (ç«¹ç§‘)", "éŠ€åº§ç‚å ‚æ‹‰éºµ"]
            },
            {
                category: "æ—¥å¼å£½å¸/å±…é…’å±‹",
                meal_times: ["evening", "late_night"],
                restaurants: ["äº¬ç”ºå®¶æ—¥å¼ä¸²ç‡’å±…é…’å±‹", "å±±ä¸Šèµ°èµ°æ—¥å¼ç„¡èœå–®ç‡’è‚‰", "å–œæ†¨å…’å‰µä½œæ–™ç† (æ—¥å¼åƒåˆ°é£½)", "å®¶ç«¹äº­ (æ—¥å¼å®šé£Ÿ)", "ç«¹å­å±…é…’å±‹", "æ–°æ©‹é£Ÿå ‚ (æ—¥å¼/æ¸¯é»)"]
            },
            {
                category: "ç¶“å…¸å°å¼å°åƒ",
                meal_times: ["morning", "noon", "evening", "late_night"], // è¨±å¤šå°åƒå…¨å¤©ç‡Ÿæ¥­
                restaurants: ["é´¨è‚‰è¨± (ä¸­æ­£è·¯/è¨±äºŒå§Š)", "æŸ³å®¶è‚‰ç‡¥é£¯", "ç¿è¨˜æ»·è‚‰é£¯", "æ–°ç«¹åœ¨åœ°ç±³ç²‰/è²¢ä¸¸", "è¥¿å¸‚ç±³ç²‰æ¹¯", "è€é»ƒè±¬è…³å¤§ç‹", "é·¹ç‹è‚‰åœ“", "æ›¾è¨˜é¤¡é¤…", "åŒ—é–€ç‚¸ç²¿", "ä¸­å¤®å¸‚å ´ç³¯ç±³æ°´é¤ƒ"]
            },
            {
                category: "ç‰¹è‰²éºµé£Ÿ/å¿«é¤",
                meal_times: ["morning", "noon", "evening"],
                restaurants: ["æ®µç´”è²ç‰›è‚‰éºµ (æ­¦é™µåº—)", "åšé†ç‰›è‚‰éºµ", "é¾æ˜Œå°é¤¨ (éºµé£Ÿ/å¿«é¤)", "ç‰½æ¼¿åº— (å‚³çµ±å°åƒ)", "é˜¿å©†æ—©é¤éºµåº— (ç‚’æ‰‹éºµ)", "å”¯ä»”é­·é­šç¾¹éºµ"]
            },
            {
                category: "éº»è¾£é‹/è–‘æ¯é´¨",
                meal_times: ["evening", "late_night"],
                restaurants: ["è€å››å·å·´èœ€éº»è¾£ç‡™ (ç«¹åŒ—)", "å­”é‡‘éº»è¾£é‹", "è€ç€‹é™½é…¸ç™½èœé‹", "è€åº—è–‘æ¯é› (å†¬ä»¤é€²è£œ)", "å§œéº»è¾£å°ç«é‹", "é•·èˆˆé‡£è¦å ´ (ç†±ç‚’/éº»è¾£è‡­è±†è…)"]
            },
            {
                category: "ä¸€èˆ¬ç«é‹/åƒåˆ°é£½",
                meal_times: ["noon", "evening"],
                restaurants: ["æµ·åº•æ’ˆ (å¤§é ç™¾)", "åƒè‘‰ç«é‹", "ä¹å“å°ç«é‹", "é‹æ¹¯åŒ¯ (24Hå°ç«é‹)", "ç¯‰é–“å¹¸ç¦é‹ç‰©", "èšåŒ—æµ·é“æ˜†å¸ƒé‹"]
            },
            {
                category: "ç¾©å¼/æ­å¼é¤å»³",
                meal_times: ["noon", "evening"],
                restaurants: ["ç¾©å¼å±‹å¤æ‹‰çˆµ (å¤§é ç™¾)", "å‡¡å¦®èå—æ­èŠ±åœ’é¤å»³", "å¢¨å’–å•¡ (ç¾©å¼)", "çª¯çƒ¤æŠ«è–©å·¥åŠ", "æ‰˜æ–¯å¡å°¼å°¼ (ç«¹ç§‘)", "æ›¼æ‰˜ç“¦ç¾©å¼å»šæˆ¿", "æ–‘é¦¬é¨·èç¾ç¾©é¤å»³"]
            },
            {
                category: "ç¾å¼é¤å»³/ç‰›æ’",
                meal_times: ["noon", "evening"],
                restaurants: ["å²å¦åˆ©ç¾å¼ç‰›æ’", "A CUTç‰›æ’é¤¨ (åœ‹è³“)", "LALA Kitchen (æ–°ç¾å¼)", "è²³æ¨“é¤å»³ (æ–°ç«¹åº—)", "éº¥ç•¶å‹ (æ–°ç«¹è»Šç«™)", "æ¼¢å ¡ç‹ (å·¨åŸ)", "ç¾å¼å»šæˆ¿"]
            },
            {
                category: "æ¸¯å¼é£²èŒ¶/é»å¿ƒ",
                meal_times: ["noon", "evening"],
                restaurants: ["çæ‚…æ¸¯å¼é»å¿ƒåŠ", "æ™¶æ‚…æ¸¯å¼é£²èŒ¶", "è’¸ç± æ¸¯å¼é£²èŒ¶", "å¤§å››å–œæ¸¯å¼é»å¿ƒ", "æ–°æ©‹é£Ÿå ‚ (æ¸¯é»)"]
            },
            {
                category: "æ³°å¼/å—æ´‹æ–™ç†",
                meal_times: ["noon", "evening"],
                restaurants: ["ç“¦åŸ (å·¨åŸ/å¤§é ç™¾)", "æ™¶æ¹¯åŒ™æ³°å¼ä¸»é¡Œé¤å»³", "è—è±¡å»·æ³°å¼ç«é‹åƒåˆ°é£½", "æ³°ä¹‹å‘³æ³°å¼æ–™ç†", "æ™¶æ¹¯åŒ™"]
            },
            {
                category: "éŸ“å¼æ–™ç†/ç‡’è‚‰",
                meal_times: ["noon", "evening"],
                restaurants: ["å§œæ»¿å ‚æ­£å®—éŸ“åœ‹ç›´ç«ç‡’è‚‰", "éŸ“åœ‹é¤¨", "éŠ…ç›¤éŸ“å¼çƒ¤è‚‰", "å…©é¤éŸ“åœ‹å¹´ç³•ç«é‹åƒåˆ°é£½"]
            },
            {
                category: "æ—©åˆé¤/è¼•é£Ÿ",
                meal_times: ["morning", "noon"],
                restaurants: ["é˜¿å©†æ—©é¤éºµåº— (æ—©åˆé¤)", "æ¬£åœ’æ—©é»", "å¥½äº‹å’–å•¡", "Subway", "æˆ–è€…æ›¸åº—é¤é£²", "å–œæœ¨å’–å•¡ (æ—©åˆé¤)", "éµä¸‰è§’ç¢³çƒ¤åå¸ (è¼•é£Ÿ)"]
            },
            {
                category: "å’–å•¡/ç”œé»",
                meal_times: ["morning", "noon", "evening"],
                restaurants: ["å¢¨å’–å•¡", "å°å¢Šå­ I'm Mat", "é‡è¦‹å’–å•¡", "å¡æ¯”å’–å•¡ (è²“é¤å»³)", "é€å…‰æ£‰èŠ± (ç”œé»)", "ç¦æºèŠ±ç”Ÿé†¬ (æ±å¤§è·¯/ç”œé»)", "ç¥ä»™ç‰›ä¹³å¤§ç‹ (ç”œé»)"]
            }
        ];
        
        // å°‡æ‰€æœ‰é¡åˆ¥åç¨±æå–å‡ºä¾†ç”¨æ–¼åˆå§‹é¡¯ç¤º
        const foodCategories = foodData.map(item => item.category); 

        // 2. ç²å– DOM å…ƒç´ 
        const spinButton = document.getElementById('spin-button');
        const resultDisplay = document.getElementById('result-display');
        const categoryListDisplay = document.getElementById('category-list');
        const buttonText = document.getElementById('button-text');
        
        const finalRestaurantDisplay = document.getElementById('final-restaurant-display');
        const chosenRestaurant = document.getElementById('chosen-restaurant');
        const chosenCategoryText = document.getElementById('chosen-category-text');
        const infoLinksContainer = document.getElementById('info-links-container');
        const linkMap = document.getElementById('link-map');
        
        const mapContainer = document.getElementById('map-container');
        const mapIframe = document.getElementById('map-iframe');

        // åˆå§‹åŒ–é¡¯ç¤ºé¡åˆ¥æ¸…å–®
        categoryListDisplay.textContent = foodCategories.join(" Â· ");

        /**
         * è¼”åŠ©å‡½æ•¸ï¼šå–å¾—é¸ä¸­çš„é¤æœŸ (morning/noon/evening/late_night)
         */
        function getSelectedMealTime() {
            const selectedRadio = document.querySelector('input[name="meal-time"]:checked');
            return selectedRadio ? selectedRadio.value : null;
        }

        /**
         * 3. æ ¸å¿ƒåŠŸèƒ½ï¼šåŸ·è¡Œè½‰ç›¤é‚è¼¯
         */
        function startSpin() {
            const selectedTime = getSelectedMealTime();
            if (!selectedTime) {
                alert("è«‹å…ˆé¸æ“‡æƒ³ç”¨é¤çš„æ™‚æ®µï¼");
                return;
            }

            // æ ¹æ“šé¸ä¸­çš„æ™‚æ®µéæ¿¾é¤å»³æ•¸æ“š
            const filteredFoodData = foodData.filter(item => item.meal_times.includes(selectedTime));
            
            if (filteredFoodData.length === 0) {
                resultDisplay.textContent = "æŠ±æ­‰ï¼Œè©²æ™‚æ®µæ²’æœ‰é©åˆçš„é¤å»³ï¼";
                resultDisplay.classList.remove('result-highlight');
                finalRestaurantDisplay.classList.add('hidden');
                infoLinksContainer.classList.add('hidden');
                mapContainer.classList.add('hidden');
                return;
            }

            // ç¦ç”¨æŒ‰éˆ•ä¸¦å•Ÿå‹•è¦–è¦ºæ•ˆæœ
            spinButton.disabled = true;
            spinButton.classList.add('opacity-60', 'spin-active');
            
            // éš±è—çµæœå€åŸŸ
            finalRestaurantDisplay.classList.add('hidden');
            infoLinksContainer.classList.add('hidden');
            mapContainer.classList.add('hidden');

            resultDisplay.classList.remove('result-highlight');
            buttonText.textContent = 'æ±ºå®šä¸­...';

            let spinningInterval;
            let spinCount = 0;
            const maxSpins = 20; 
            const duration = 2000; 
            const intervalTime = duration / maxSpins; 

            // é–‹å§‹æ¨¡æ“¬å¿«é€Ÿé–ƒçˆ/è½‰å‹• (ä½¿ç”¨éæ¿¾å¾Œçš„æ•¸æ“š)
            spinningInterval = setInterval(() => {
                const tempIndex = Math.floor(Math.random() * filteredFoodData.length);
                resultDisplay.textContent = filteredFoodData[tempIndex].category;
                
                spinCount++;

                if (spinCount >= maxSpins) {
                    clearInterval(spinningInterval);
                    finishSpin(filteredFoodData);
                }
            }, intervalTime);
        }

        /**
         * 4. çµæŸè½‰ç›¤ä¸¦é¡¯ç¤ºçµæœèˆ‡è³‡è¨Šé€£çµ
         * @param {Array} currentFoodData - å·²ç¶“éæ¿¾çš„é¤å»³æ•¸æ“š
         */
        function finishSpin(currentFoodData) {
            // éš¨æ©Ÿé¸å‡ºæœ€çµ‚é¡åˆ¥çš„ç´¢å¼• (å¾éæ¿¾å¾Œçš„æ•¸æ“šä¸­é¸å–)
            const finalIndex = Math.floor(Math.random() * currentFoodData.length);
            const chosenDataItem = currentFoodData[finalIndex]; 
            
            const finalCategory = chosenDataItem.category;

            // å¾è©²é¡åˆ¥çš„é¤å»³æ¸…å–®ä¸­ï¼Œéš¨æ©Ÿé¸å‡ºä¸€å€‹é¤å»³
            const restaurantsList = chosenDataItem.restaurants;
            const restaurantIndex = Math.floor(Math.random() * restaurantsList.length);
            const finalRestaurantName = restaurantsList[restaurantIndex];
            
            // é¡¯ç¤ºçµæœ
            resultDisplay.textContent = finalCategory + "ï¼";
            resultDisplay.classList.add('result-highlight');

            // é¡¯ç¤ºæœ€çµ‚é¤å»³åç¨±
            chosenRestaurant.textContent = finalRestaurantName;
            chosenCategoryText.textContent = `é¤é»é¡å‹ï¼š${finalCategory}`;
            finalRestaurantDisplay.classList.remove('hidden');

            // é‡æ–°å•Ÿç”¨æŒ‰éˆ•ä¸¦ç§»é™¤æ•ˆæœ
            spinButton.disabled = false;
            spinButton.classList.remove('opacity-60', 'spin-active');
            buttonText.textContent = 'å†è½‰ä¸€æ¬¡ï¼';

            // ***** æ ¸å¿ƒï¼šåœ°åœ–åµŒå…¥èˆ‡é€£çµ *****
            const baseQuery = `æ–°ç«¹å¸‚ ${finalRestaurantName}`; 
            
            // 1. åµŒå…¥åœ°åœ– (å˜—è©¦åœ¨åŒé é¡¯ç¤º)
            const embedUrl = `https://maps.google.com/maps?q=${encodeURIComponent(baseQuery)}&z=14&output=embed`;
            mapIframe.src = embedUrl;

            // 2. å‚™ç”¨é€£çµ (è‹¥åµŒå…¥å¤±æ•—ï¼Œå¯å¦é–‹æ–°é )
            linkMap.href = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(baseQuery)}`;

            // é¡¯ç¤ºåœ°åœ–å®¹å™¨å’Œå–®ä¸€å‚™ç”¨é€£çµ
            mapContainer.classList.remove('hidden');
            infoLinksContainer.classList.remove('hidden');
        }

        // 5. ç›£è½æŒ‰éˆ•é»æ“Šäº‹ä»¶
        spinButton.addEventListener('click', startSpin);

    </script>
</body>
</html>